<script src="scripts/jquery-file-upload/jquery.ui.widget.js"></script>
<script src="scripts/jquery-file-upload/jquery.iframe-transport.js"></script>
<script src="scripts/jquery-file-upload/jquery.fileupload.js"></script>

<div>
    <h1>Uploaded patient file</h1>

    <div>
        <form>
            <p id="status"></p>

            <div id="progress">
                <div class="bar" style="width: 0%;"></div>
            </div>
            <br/>
            <input id="file" type="file" data-url="/openelis/DoUpload.do" accept="text/csv">
            <br/>
            <button type="button" id="upload">Upload</button>
        </form>
    </div>
</div>


<style>
    .bar {
        height: 18px;
        background: green;
    }
</style>

<script type="text/javascript">
    jQuery(document).ready(function () {
        jQuery('#file').fileupload({
            dataType: 'text',
            replaceFileInput: false,
            add: function (e, data) {
                data.context = jQuery('#upload')
                        .click(function () {
                            data.context = jQuery('#status').text('Uploading...');
                            data.submit();
                        });
            },
            done: function (e, data) {
                data.context.text('Upload finished.');
            },
            progressall: function (e, data) {
                var progress = parseInt(data.loaded / data.total * 100, 10);
                jQuery('#progress .bar').css(
                        'width',
                        progress + '%'
                );
            }
        });
    });
</script>
